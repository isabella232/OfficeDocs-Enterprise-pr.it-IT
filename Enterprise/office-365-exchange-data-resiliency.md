---
title: Resilienza dei dati di Exchange online in Microsoft 365
ms.author: josephd
author: JoeDavies-MSFT
manager: laurawi
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
ms.collection:
- Strat_O365_IP
- M365-security-compliance
f1.keywords:
- NOCSH
description: In questo articolo, trovare una spiegazione dei vari aspetti della resilienza dei dati in Exchange Online e Microsoft 365.
ms.custom: seo-marvel-apr2020
ms.openlocfilehash: 18d8179f37cb97316b71a43cccfc631a5cc550da
ms.sourcegitcommit: 8634215e257ba2d49832a8f5947700fd00f18ece
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/10/2020
ms.locfileid: "46606612"
---
# <a name="exchange-online-data-resiliency-in-microsoft-365"></a><span data-ttu-id="4496a-103">Resilienza dei dati di Exchange online in Microsoft 365</span><span class="sxs-lookup"><span data-stu-id="4496a-103">Exchange Online Data Resiliency in Microsoft 365</span></span>

<span data-ttu-id="4496a-104">Esistono due tipi di danneggiamento che possono influire su un database di Exchange: il danneggiamento fisico, che in genere è causato da problemi hardware (in particolare, hardware di archiviazione) e da un danneggiamento logico, che si verifica a causa di altri fattori.</span><span class="sxs-lookup"><span data-stu-id="4496a-104">There are two types of corruption that can affect an Exchange database: physical corruption, which is typically caused by hardware (in particular, storage hardware) problems, and logical corruption, which occurs due to other factors.</span></span> <span data-ttu-id="4496a-105">In generale, esistono due tipi di danneggiamenti logici che possono verificarsi in un database di Exchange:</span><span class="sxs-lookup"><span data-stu-id="4496a-105">Generally, there are two types of logical corruption that can occur within an Exchange database:</span></span> 
- <span data-ttu-id="4496a-106">**Danneggiamento logico del database** -il checksum della pagina del database corrisponde, ma i dati della pagina sono errati logicamente.</span><span class="sxs-lookup"><span data-stu-id="4496a-106">**Database logical corruption** - The database page checksum matches, but the data on the page is wrong logically.</span></span> <span data-ttu-id="4496a-107">Questo problema può verificarsi quando il motore di database (ESE) tenta di scrivere una pagina di database e, anche se il sistema operativo restituisce un messaggio di esito positivo, i dati non vengono mai scritti nel disco o sono stati scritti nel posto sbagliato.</span><span class="sxs-lookup"><span data-stu-id="4496a-107">This can occur when the database engine (the Extensible Storage Engine (ESE)) attempts to write a database page and even though the operating system returns a success message, the data is either never written to the disk or it's written to the wrong place.</span></span> <span data-ttu-id="4496a-108">Questo viene definito *rilevamento flush*.</span><span class="sxs-lookup"><span data-stu-id="4496a-108">This is referred to as a *lost flush*.</span></span> <span data-ttu-id="4496a-109">ESE include numerose funzionalità e misure di salvaguardia progettate per impedire il danneggiamento fisico di un database e di altri scenari di perdita dei dati.</span><span class="sxs-lookup"><span data-stu-id="4496a-109">ESE includes numerous features and safeguards that are designed to prevent physical corruption of a database and other data loss scenarios.</span></span> <span data-ttu-id="4496a-110">Per impedire la perdita di dati per gli scaricamenti persi, ESE include un meccanismo di rilevamento di incasso perso nel database insieme a una funzionalità (ripristino a pagina singola) per correggerla.</span><span class="sxs-lookup"><span data-stu-id="4496a-110">To prevent lost flushes from losing data, ESE includes a lost flush detection mechanism in the database along with a feature (single page restore) to correct it.</span></span> 
- <span data-ttu-id="4496a-111">**Archiviazione logica di danneggiamento** : i dati vengono aggiunti, eliminati o modificati in modo che l'utente non si aspetti.</span><span class="sxs-lookup"><span data-stu-id="4496a-111">**Store logical corruption** - Data is added, deleted, or manipulated in a way that the user doesn't expect.</span></span> <span data-ttu-id="4496a-112">Questi casi sono generalmente causati da applicazioni di terze parti.</span><span class="sxs-lookup"><span data-stu-id="4496a-112">These cases are generally caused by third-party applications.</span></span> <span data-ttu-id="4496a-113">Generalmente, questa situazione viene percepita dall'utente come un danneggiamento.</span><span class="sxs-lookup"><span data-stu-id="4496a-113">It's generally only corruption in the sense that the user views it as corruption.</span></span> <span data-ttu-id="4496a-114">L'archivio di Exchange considera la transazione che ha causato il danneggiamento della partizione logica come una serie di operazioni MAPI valide.</span><span class="sxs-lookup"><span data-stu-id="4496a-114">The Exchange store considers the transaction that produced the logical corruption to be a series of valid MAPI operations.</span></span> <span data-ttu-id="4496a-115">Le funzionalità di archiviazione sul [posto](https://docs.microsoft.com/exchange/security-and-compliance/create-or-remove-in-place-holds) in Exchange Online offrono protezione dal danneggiamento logico dell'archivio (perché impedisce che il contenuto venga eliminato definitivamente da un utente o da un'applicazione).</span><span class="sxs-lookup"><span data-stu-id="4496a-115">The [In-Place Hold](https://docs.microsoft.com/exchange/security-and-compliance/create-or-remove-in-place-holds) features in Exchange Online provides protection from store logical corruption (because it prevents content from being permanently deleted by a user or an application).</span></span> 

<span data-ttu-id="4496a-116">Exchange Online esegue diversi controlli di coerenza sui file di registro replicati durante l'ispezione dei registri e la riproduzione dei registri.</span><span class="sxs-lookup"><span data-stu-id="4496a-116">Exchange Online performs several consistency checks on replicated log files during both log inspection and log replay.</span></span> <span data-ttu-id="4496a-117">Questi controlli di coerenza impediscono la replica del danneggiamento fisico da parte del sistema.</span><span class="sxs-lookup"><span data-stu-id="4496a-117">These consistency checks prevent physical corruption from being replicated by the system.</span></span> <span data-ttu-id="4496a-118">Ad esempio, durante l'ispezione dei registri, è presente un controllo dell'integrità fisica che verifica il file di registro e convalida che il checksum registrato nel file di registro corrisponde al checksum generato in memoria.</span><span class="sxs-lookup"><span data-stu-id="4496a-118">For example, during log inspection, there is a physical integrity check which verifies the log file and validates that the checksum recorded in the log file matches the checksum generated in memory.</span></span> <span data-ttu-id="4496a-119">Viene inoltre esaminata l'intestazione del file di registro per verificare che la firma del file di registro registrata nell'intestazione del registro corrisponda a quella del file di registro.</span><span class="sxs-lookup"><span data-stu-id="4496a-119">In addition, the log file header is examined to make sure the log file signature recorded in the log header matches that of the log file.</span></span> <span data-ttu-id="4496a-120">Durante la riproduzione dei log, il file di registro subisce un ulteriore controllo.</span><span class="sxs-lookup"><span data-stu-id="4496a-120">During log replay, the log file undergoes further scrutiny.</span></span> <span data-ttu-id="4496a-121">Ad esempio, l'intestazione del database contiene anche la firma del registro che viene confrontata con la firma del file di registro per verificare che corrispondano.</span><span class="sxs-lookup"><span data-stu-id="4496a-121">For example, the database header also contains the log signature which is compared with the log file's signature to ensure they match.</span></span> 

<span data-ttu-id="4496a-122">La protezione contro la corruzione dei dati delle cassette postali in Exchange Online viene ottenuta utilizzando la protezione dei dati nativi di Exchange, una strategia di resilienza che sfrutta la replica a livello di applicazione tra più server e più datacenter insieme ad altre caratteristiche che consentono di proteggere i dati da perdite dovute a danneggiamenti o altri motivi.</span><span class="sxs-lookup"><span data-stu-id="4496a-122">Protection against corruption of mailbox data in Exchange Online is achieved by using Exchange Native Data Protection, a resiliency strategy that leverages application-level replication across multiple servers and multiple datacenters along with other features that help protect data from being lost due to corruption or other reasons.</span></span> <span data-ttu-id="4496a-123">Queste funzionalità includono funzionalità native gestite da Microsoft o dall'applicazione Exchange Online, ad esempio:</span><span class="sxs-lookup"><span data-stu-id="4496a-123">These features include native features that are managed by Microsoft or the Exchange Online application itself, such as:</span></span>

- [<span data-ttu-id="4496a-124">Gruppi di disponibilità dei dati</span><span class="sxs-lookup"><span data-stu-id="4496a-124">Data Availability Groups</span></span>](https://docs.microsoft.com/exchange/back-up-email)
- <span data-ttu-id="4496a-125">Correzione bit singolo</span><span class="sxs-lookup"><span data-stu-id="4496a-125">Single Bit Correction</span></span> 
- <span data-ttu-id="4496a-126">Analisi dei database online</span><span class="sxs-lookup"><span data-stu-id="4496a-126">Online Database Scanning</span></span> 
- <span data-ttu-id="4496a-127">Rilevamento di incasso perso</span><span class="sxs-lookup"><span data-stu-id="4496a-127">Lost Flush Detection</span></span> 
- <span data-ttu-id="4496a-128">Ripristino di una singola pagina</span><span class="sxs-lookup"><span data-stu-id="4496a-128">Single Page Restore</span></span> 
- <span data-ttu-id="4496a-129">Servizio di replica delle cassette postali</span><span class="sxs-lookup"><span data-stu-id="4496a-129">Mailbox Replication Service</span></span> 
- <span data-ttu-id="4496a-130">Controlli file di registro</span><span class="sxs-lookup"><span data-stu-id="4496a-130">Log File Checks</span></span> 
- <span data-ttu-id="4496a-131">Distribuzione nel file System resiliente</span><span class="sxs-lookup"><span data-stu-id="4496a-131">Deployment on Resilient File System</span></span> 

<span data-ttu-id="4496a-132">Per ulteriori informazioni sulle caratteristiche native sopra elencate, fare clic sui collegamenti ipertestuali sopra riportati e vedere di seguito per ulteriori informazioni e per dettagli sugli elementi senza collegamenti ipertestuali.</span><span class="sxs-lookup"><span data-stu-id="4496a-132">For more information on the native features listed above, click on the above hyperlinks, and see below for additional information and for details on items without hyperlinks.</span></span> <span data-ttu-id="4496a-133">Oltre a queste funzionalità native, Exchange Online include anche funzionalità di resilienza dei dati che i clienti possono gestire, ad esempio:</span><span class="sxs-lookup"><span data-stu-id="4496a-133">In addition to these native features, Exchange Online also includes data resiliency features that customers can manage, such as:</span></span> 
- [<span data-ttu-id="4496a-134">Ripristino di un singolo elemento (abilitata per impostazione predefinita)</span><span class="sxs-lookup"><span data-stu-id="4496a-134">Single Item Recovery (enabled by default)</span></span>](https://docs.microsoft.com/exchange/recipients-in-exchange-online/manage-user-mailboxes/recover-deleted-messages) 
- [<span data-ttu-id="4496a-135">Conservazione in locale e per controversia legale</span><span class="sxs-lookup"><span data-stu-id="4496a-135">In-Place Hold and Litigation Hold</span></span>](https://docs.microsoft.com/exchange/security-and-compliance/in-place-and-litigation-holds) 
- [<span data-ttu-id="4496a-136">Conservazione degli elementi eliminati e cassette postali eliminate temporaneamente (entrambi abilitati per impostazione predefinita)</span><span class="sxs-lookup"><span data-stu-id="4496a-136">Deleted Item Retention and Soft-Deleted Mailboxes (both enabled by default)</span></span>](https://docs.microsoft.com/exchange/recipients-in-exchange-online/delete-or-restore-mailboxes) 

## <a name="database-availability-groups"></a><span data-ttu-id="4496a-137">Gruppi di disponibilità del database</span><span class="sxs-lookup"><span data-stu-id="4496a-137">Database Availability Groups</span></span> 
<span data-ttu-id="4496a-138">Ogni database delle cassette postali in Microsoft 365 è ospitato in un [gruppo di disponibilità del database (DAG)](https://docs.microsoft.com/exchange/back-up-email) e replicato in datacenter geograficamente separati all'interno della stessa area.</span><span class="sxs-lookup"><span data-stu-id="4496a-138">Every mailbox database in Microsoft 365 is hosted in a [database availability group (DAG)](https://docs.microsoft.com/exchange/back-up-email) and replicated to geographically-separate datacenters within the same region.</span></span> <span data-ttu-id="4496a-139">La configurazione più comune è costituita da quattro copie del database in quattro datacenter. Tuttavia, alcune aree dispongono di un numero minore di centri dati (i database vengono replicati in tre datacenter in India e due datacenter in Australia e Giappone).</span><span class="sxs-lookup"><span data-stu-id="4496a-139">The most common configuration is four database copies in four datacenters; however, some regions have fewer datacenters (databases are replicated to three datacenters in India, and two datacenters in Australia and Japan).</span></span> <span data-ttu-id="4496a-140">Tuttavia, in tutti i casi, ogni database delle cassette postali dispone di quattro copie distribuite su più datacenter, garantendo così che i dati delle cassette postali siano protetti da errori software, hardware e persino del datacenter.</span><span class="sxs-lookup"><span data-stu-id="4496a-140">But in all cases, every mailbox database has four copies that are distributed across multiple datacenters, thereby ensuring that mailbox data is protected from software, hardware, and even datacenter failures.</span></span> 

<span data-ttu-id="4496a-141">Tra queste quattro copie, tre sono configurate come estremamente disponibili.</span><span class="sxs-lookup"><span data-stu-id="4496a-141">Out of these four copies, three of them are configured as highly available.</span></span> <span data-ttu-id="4496a-142">La quarta copia è configurata come [copia del database ritardata](https://docs.microsoft.com/Exchange/high-availability/manage-ha/activate-lagged-db-copies).</span><span class="sxs-lookup"><span data-stu-id="4496a-142">The fourth copy is configured as a [lagged database copy](https://docs.microsoft.com/Exchange/high-availability/manage-ha/activate-lagged-db-copies).</span></span> <span data-ttu-id="4496a-143">La copia del database ritardata non è progettata per il ripristino di una singola cassetta postale o per il recupero di un elemento.</span><span class="sxs-lookup"><span data-stu-id="4496a-143">The lagged database copy is not intended for individual mailbox recovery or mailbox item recovery.</span></span> <span data-ttu-id="4496a-144">Lo scopo è quello di fornire un meccanismo di ripristino per l'evento raro di un danneggiamento logico irreversibile a livello di sistema.</span><span class="sxs-lookup"><span data-stu-id="4496a-144">Its purpose is to provide a recovery mechanism for the rare event of system-wide, catastrophic logical corruption.</span></span> 

<span data-ttu-id="4496a-145">Le copie ritardate del database in Exchange Online sono configurate con un intervallo di riesecuzione dei file di registro di sette giorni.</span><span class="sxs-lookup"><span data-stu-id="4496a-145">Lagged database copies in Exchange Online are configured with a seven-day log file replay lag time.</span></span> <span data-ttu-id="4496a-146">Inoltre, il gestore di lag di riesecuzione di Exchange è abilitato a fornire un file di registro dinamico riprodotto per le copie ritardate in modo da consentire le copie ritardate del database per la correzione automatica e la gestione dello sviluppo dei file di registro.</span><span class="sxs-lookup"><span data-stu-id="4496a-146">In addition, the Exchange Replay Lag Manager is enabled to provide dynamic log file play down for lagged copies to allow lagged database copies to self-repair and manage log file growth.</span></span> <span data-ttu-id="4496a-147">Anche se le copie del database ritardate vengono utilizzate in Exchange Online, è importante comprendere che non sono un backup temporizzato garantito.</span><span class="sxs-lookup"><span data-stu-id="4496a-147">Although lagged database copies are used in Exchange Online, it is important to understand that they are not a guaranteed point-in-time backup.</span></span> <span data-ttu-id="4496a-148">Le copie ritardate del database in Exchange Online hanno una soglia di disponibilità, in genere attorno al 90%, a causa di periodi in cui il disco contenente una copia ritardata viene perso a causa di un errore del disco, la copia ritardata diventa una copia estremamente disponibile (a causa del riutilizzo automatico), nonché i periodi in cui la copia del database ritardata ricostruisce la coda di</span><span class="sxs-lookup"><span data-stu-id="4496a-148">Lagged database copies in Exchange Online have an availability threshold, typically around 90%, due to periods where the disk containing a lagged copy is lost due to disk failure, the lagged copy becoming a highly-available copy (due to automatic play down), as well as the periods where the lagged database copy is re-building the log replay queue.</span></span> 

## <a name="transport-resilience"></a><span data-ttu-id="4496a-149">Resilienza del trasporto</span><span class="sxs-lookup"><span data-stu-id="4496a-149">Transport Resilience</span></span> 
<span data-ttu-id="4496a-150">Exchange Online include due caratteristiche di resilienza del trasporto principali: la ridondanza shadow e la rete sicura.</span><span class="sxs-lookup"><span data-stu-id="4496a-150">Exchange Online includes two primary transport resilience features: Shadow Redundancy and Safety Net.</span></span> <span data-ttu-id="4496a-151">La ridondanza shadow conserva una copia ridondante di un messaggio mentre è in transito.</span><span class="sxs-lookup"><span data-stu-id="4496a-151">Shadow Redundancy keeps a redundant copy of a message while it is in transit.</span></span> <span data-ttu-id="4496a-152">La rete sicura mantiene una copia ridondante di un messaggio dopo che il messaggio è stato recapitato correttamente.</span><span class="sxs-lookup"><span data-stu-id="4496a-152">Safety Net keeps a redundant copy of a message after the message is successfully delivered.</span></span> 

<span data-ttu-id="4496a-153">Con la ridondanza shadow, ogni server di trasporto Exchange Online crea una copia di ogni messaggio che riceve prima di riconoscere la ricezione del messaggio al server di invio.</span><span class="sxs-lookup"><span data-stu-id="4496a-153">With Shadow Redundancy, each Exchange Online transport server makes a copy of each message it receives before it acknowledges successfully receiving the message to the sending server.</span></span> <span data-ttu-id="4496a-154">In questo modo, tutti i messaggi nella pipeline di trasporto sono ridondanti mentre sono in transito.</span><span class="sxs-lookup"><span data-stu-id="4496a-154">This makes all messages in the transport pipeline redundant while in transit.</span></span> <span data-ttu-id="4496a-155">Se Exchange Online determina che il messaggio originale è stato perso durante il trasporto, viene recapitata una copia ridondante del messaggio.</span><span class="sxs-lookup"><span data-stu-id="4496a-155">If Exchange Online determines the original message was lost in transit, a redundant copy of the message is redelivered.</span></span> 

<span data-ttu-id="4496a-156">Safety net è una coda di trasporto associata al servizio di trasporto su un server cassette postali.</span><span class="sxs-lookup"><span data-stu-id="4496a-156">Safety Net is a transport queue that is associated with the Transport service on a Mailbox server.</span></span> <span data-ttu-id="4496a-157">In questa coda vengono archiviate le copie dei messaggi elaborati correttamente dal server.</span><span class="sxs-lookup"><span data-stu-id="4496a-157">This queue stores copies of messages that were successfully processed by the server.</span></span> <span data-ttu-id="4496a-158">Quando un database delle cassette postali o un errore del server richiede l'attivazione di una copia obsoleta del database delle cassette postali, i messaggi nella coda della rete sicura vengono reinoltrati automaticamente alla nuova copia attiva del database delle cassette postali.</span><span class="sxs-lookup"><span data-stu-id="4496a-158">When a mailbox database or server failure requires activating an out-of-date copy of the mailbox database, messages in the Safety Net queue are automatically resubmitted to the new active copy of the mailbox database.</span></span> <span data-ttu-id="4496a-159">Anche la rete sicura è ridondante, eliminando così il trasporto come singolo punto di errore.</span><span class="sxs-lookup"><span data-stu-id="4496a-159">Safety Net is also redundant, thereby eliminating transport as a single point of failure.</span></span> <span data-ttu-id="4496a-160">Utilizza il concetto di una rete sicura primaria e una rete di sicurezza Shadow in cui se la rete sicura primaria non è disponibile per più di 12 ore, le richieste di reinvio diventano richieste di reinvio Shadow e i messaggi vengono recapitati dalla rete sicura Shadow.</span><span class="sxs-lookup"><span data-stu-id="4496a-160">It uses the concept of a Primary Safety Net and a Shadow Safety Net wherein if the Primary Safety Net is unavailable for more than 12 hours, resubmit requests become shadow resubmit requests, and messages are re-delivered from the Shadow Safety Net.</span></span>

<span data-ttu-id="4496a-161">I reinvii dei messaggi dalla rete sicura vengono avviati automaticamente dal componente Active Manager del servizio replica di Microsoft Exchange che gestisce i DAG e le copie del database delle cassette postali.</span><span class="sxs-lookup"><span data-stu-id="4496a-161">Message resubmissions from Safety Net are automatically initiated by the Active Manager component of the Microsoft Exchange Replication service that manages DAGs and mailbox database copies.</span></span> <span data-ttu-id="4496a-162">Per reinviare i messaggi dalla rete sicura non sono necessarie azioni manuali.</span><span class="sxs-lookup"><span data-stu-id="4496a-162">No manual actions are required to resubmit messages from Safety Net.</span></span> 

## <a name="single-bit-correction"></a><span data-ttu-id="4496a-163">Correzione bit singolo</span><span class="sxs-lookup"><span data-stu-id="4496a-163">Single Bit Correction</span></span> 
<span data-ttu-id="4496a-164">ESE include un meccanismo per rilevare e risolvere gli errori CRC a bit singolo (aka Flip a bit singolo) che sono il risultato di errori hardware (e come tali rappresentano un danneggiamento fisico).</span><span class="sxs-lookup"><span data-stu-id="4496a-164">ESE includes a mechanism to detect and resolve single-bit CRC errors (aka single-bit flips) that are the result of hardware errors (and as such they represent physical corruption).</span></span> <span data-ttu-id="4496a-165">Quando si verificano questi errori, ESE corregge automaticamente gli eventi e registra un evento nel registro eventi.</span><span class="sxs-lookup"><span data-stu-id="4496a-165">When these errors occur, ESE automatically corrects them and logs an event in the event log.</span></span> 

## <a name="online-database-scanning"></a><span data-ttu-id="4496a-166">Analisi dei database online</span><span class="sxs-lookup"><span data-stu-id="4496a-166">Online Database Scanning</span></span> 
<span data-ttu-id="4496a-167">L'analisi dei database online (nota anche come *database checksum dei*) è il processo in cui un ESE utilizza un verificatore di coerenza del database per leggere ogni pagina e controllare il danneggiamento di una pagina.</span><span class="sxs-lookup"><span data-stu-id="4496a-167">Online database scanning (also known as *database checksumming*) is the process where an ESE uses a database consistency checker to read each page and check for page corruption.</span></span> <span data-ttu-id="4496a-168">Lo scopo principale è rilevare il danneggiamento fisico e i rossore persi che potrebbero non essere rilevati dalle operazioni transazionali.</span><span class="sxs-lookup"><span data-stu-id="4496a-168">The primary purpose is to detect physical corruption and lost flushes that may not be getting detected by transactional operations.</span></span> <span data-ttu-id="4496a-169">L'analisi dei database esegue anche operazioni di arresto anomalo successive all'archiviazione.</span><span class="sxs-lookup"><span data-stu-id="4496a-169">Database scanning also performs post-store crash operations.</span></span> <span data-ttu-id="4496a-170">Lo spazio può essere fuoriuscito a causa di arresti anomali e l'analisi dei database online rileva e recupera lo spazio perso.</span><span class="sxs-lookup"><span data-stu-id="4496a-170">Space can be leaked due to crashes, and online database scanning finds and recovers lost space.</span></span> <span data-ttu-id="4496a-171">Il sistema è stato creato con l'aspettativa che ogni database sia completamente analizzato una volta ogni sette giorni.</span><span class="sxs-lookup"><span data-stu-id="4496a-171">The system is designed with the expectation that every database is fully scanned once every seven days.</span></span> 

## <a name="lost-flush-detection"></a><span data-ttu-id="4496a-172">Rilevamento di incasso perso</span><span class="sxs-lookup"><span data-stu-id="4496a-172">Lost Flush Detection</span></span> 
<span data-ttu-id="4496a-173">Uno svuotamento perso si verifica quando un'operazione di scrittura del database che il sottosistema del disco o il sistema operativo restituito come completato non è stata effettivamente scritta su disco oppure è stata scritta nella posizione errata.</span><span class="sxs-lookup"><span data-stu-id="4496a-173">A lost flush occurs when a database write operation that the disk subsystem/operating system returned as completed did not actually get written to disk, or was written in the wrong location.</span></span> <span data-ttu-id="4496a-174">Gli incidenti di incasso persi possono comportare un danneggiamento logico del database, in modo da evitare che i risciacquo persi provochino dati persi, ESE include un meccanismo di rilevamento di incasso perduto.</span><span class="sxs-lookup"><span data-stu-id="4496a-174">Lost flush incidents can result in database logical corruption, so to prevent lost flushes from resulting in lost data, ESE includes a lost flush detection mechanism.</span></span> <span data-ttu-id="4496a-175">Quando le pagine di database vengono scritte in copie passive, viene eseguito un controllo per gli scaricamenti persi sulla copia attiva.</span><span class="sxs-lookup"><span data-stu-id="4496a-175">As database pages are written to passive copies, a check is performed for lost flushes on the active copy.</span></span> <span data-ttu-id="4496a-176">Se viene rilevato un colore perso, ESE può riparare il processo utilizzando un processo di applicazione di patch per le pagine.</span><span class="sxs-lookup"><span data-stu-id="4496a-176">If a lost flush is detected, ESE can repair the process using a page patching process.</span></span> 

## <a name="single-page-restore"></a><span data-ttu-id="4496a-177">Ripristino di una singola pagina</span><span class="sxs-lookup"><span data-stu-id="4496a-177">Single Page Restore</span></span> 
<span data-ttu-id="4496a-178">Il ripristino di una pagina singola, ovvero l'applicazione di *patch*, è un processo automatico in cui le pagine danneggiate del database vengono sostituite da copie integre da una replica sana.</span><span class="sxs-lookup"><span data-stu-id="4496a-178">Single page restore, aka *page patching*, is an automatic process where corrupt database pages are replaced by healthy copies from a healthy replica.</span></span> <span data-ttu-id="4496a-179">Il processo di ripristino di una pagina danneggiata dipende dal fatto che la copia del database sia attiva o passiva.</span><span class="sxs-lookup"><span data-stu-id="4496a-179">The repair process for a corrupt page depends on whether the database copy is active or passive.</span></span> <span data-ttu-id="4496a-180">Quando una copia attiva di un database incontra una pagina danneggiata, può copiare una pagina da una delle relative repliche, purché la pagina in cui viene copiato sia completamente aggiornata.</span><span class="sxs-lookup"><span data-stu-id="4496a-180">When an active database copy encounters a corrupted page, it can copy a page from one of its replicas, provided the page it copies is completely up-to-date.</span></span> <span data-ttu-id="4496a-181">Questa operazione viene eseguita inserendo una richiesta per la pagina nel flusso di log, che è la base della replica del database delle cassette postali.</span><span class="sxs-lookup"><span data-stu-id="4496a-181">This is accomplished by putting a request for the page into the log stream, which is the basis of mailbox database replication.</span></span> <span data-ttu-id="4496a-182">Non appena una replica rileva la richiesta di pagina risponde inviando una copia della pagina alla copia del database richiedente.</span><span class="sxs-lookup"><span data-stu-id="4496a-182">As soon as a replica encounters the page request it responds by sending a copy of the page to the requesting database copy.</span></span> <span data-ttu-id="4496a-183">Il ripristino di una singola pagina fornisce anche un meccanismo di comunicazione asincrono per l'attivo per richiedere una pagina dalle repliche, anche se le repliche sono attualmente offline.</span><span class="sxs-lookup"><span data-stu-id="4496a-183">Single page restore also provides an asynchronous communication mechanism for the active to request a page from replicas, even if the replicas are currently offline.</span></span> 

<span data-ttu-id="4496a-184">In caso di danneggiamento in una copia passiva del database, inclusa una copia del database ritardata, poiché queste copie sono sempre dietro la loro copia attiva, è sempre possibile copiare una pagina dalla copia attiva a una copia passiva.</span><span class="sxs-lookup"><span data-stu-id="4496a-184">In case of corruption in a passive database copy, including a lagged database copy, because these copies are always behind their active copy, it is always safe to copy any page from the active copy to a passive copy.</span></span> <span data-ttu-id="4496a-185">Una copia passiva del database è a disponibilità elevata, pertanto, durante il processo di applicazione delle patch, la riproduzione del registro viene sospesa, ma la copia del registro continua.</span><span class="sxs-lookup"><span data-stu-id="4496a-185">A passive database copy is by nature highly available, so during the page patching process, log replaying is suspended, but log copying continues.</span></span> <span data-ttu-id="4496a-186">La copia passiva del database recupera una copia della pagina danneggiata dalla copia attiva, attende che il file di registro che soddisfa il requisito massimo necessario per la generazione dei registri venga copiato e ispezionato e quindi patch la pagina danneggiata.</span><span class="sxs-lookup"><span data-stu-id="4496a-186">The passive database copy retrieves a copy of the corrupted page from the active copy, waits until the log file which meets the maximum required log generation requirement is copied and inspected, and then patches the corrupt page.</span></span> <span data-ttu-id="4496a-187">Dopo la correzione della pagina, la riproduzione del registro riprende.</span><span class="sxs-lookup"><span data-stu-id="4496a-187">Once the page has been patched, log replay resumes.</span></span> <span data-ttu-id="4496a-188">Il processo è lo stesso per la copia ritardata del database, tranne per il fatto che il database ritardato riproduce tutti i file di registro necessari per ottenere uno stato patchable.</span><span class="sxs-lookup"><span data-stu-id="4496a-188">The process is the same for the lagged database copy, except that the lagged database first replays all log files that are necessary to achieve a patchable state.</span></span> 

## <a name="mailbox-replication-service"></a><span data-ttu-id="4496a-189">Servizio di replica delle cassette postali</span><span class="sxs-lookup"><span data-stu-id="4496a-189">Mailbox Replication Service</span></span> 
<span data-ttu-id="4496a-190">Lo spostamento delle cassette postali è una parte fondamentale della gestione di un servizio di posta elettronica su larga scala.</span><span class="sxs-lookup"><span data-stu-id="4496a-190">Moving mailboxes is a key part of managing a large-scale email service.</span></span> <span data-ttu-id="4496a-191">Sono sempre aggiornate le tecnologie e gli aggiornamenti per l'hardware e la versione da gestire, quindi disporre di un sistema robusto e limitato che consente ai propri ingegneri di realizzare questo lavoro mantenendo la trasparenza degli spostamenti delle cassette postali per gli utenti (assicurandosi che rimangano online durante tutto il processo) sia fondamentale e che il processo venga applicato in modo graduale quando le cassette postali aumentano</span><span class="sxs-lookup"><span data-stu-id="4496a-191">There are always updated technologies and hardware and version upgrades to deal with, so having a robust, throttled system that enables our engineers to accomplish this work while keeping the mailbox moves transparent to users (by making sure they stay online throughout the process) is key and making sure that the process scales up gracefully as mailboxes get larger and larger.</span></span> 

<span data-ttu-id="4496a-192">Il servizio di replica delle cassette postali di Exchange (MRS) è responsabile dello spostamento delle cassette postali tra database.</span><span class="sxs-lookup"><span data-stu-id="4496a-192">The Exchange Mailbox Replication Service (MRS) is responsible for moving mailboxes between databases.</span></span> <span data-ttu-id="4496a-193">Durante lo spostamento, la signora esegue una verifica della coerenza su tutti gli elementi all'interno della cassetta postale.</span><span class="sxs-lookup"><span data-stu-id="4496a-193">During the move, MRS performs a consistency check on all items within the mailbox.</span></span> <span data-ttu-id="4496a-194">Se si verifica un problema di coerenza, la signora correggerà il problema oppure ignorerà gli elementi danneggiati, rimuovendo così il danneggiamento dalla cassetta postale.</span><span class="sxs-lookup"><span data-stu-id="4496a-194">If a consistency issue is found, MRS will either correct the problem, or skip the corrupted items, thereby removing the corruption from the mailbox.</span></span> 

<span data-ttu-id="4496a-195">Poiché la signora è un componente di Exchange Online, è possibile apportare modifiche al codice per risolvere nuove forme di danneggiamento che vengono rilevate in futuro.</span><span class="sxs-lookup"><span data-stu-id="4496a-195">Because MRS is a component of Exchange Online, we can make changes in its code to address new forms of corruption that are detected in the future.</span></span> <span data-ttu-id="4496a-196">Ad esempio, se si rileva un problema di coerenza che la signora non è in grado di risolvere, è possibile analizzare il danneggiamento, modificare il codice MRS e correggere l'incongruenza (se si capisce come).</span><span class="sxs-lookup"><span data-stu-id="4496a-196">For example, if we detect a consistency issue that MRS is not able to fix, we can analyze the corruption, change the MRS code and correct the inconsistency (if we understand how to).</span></span> 

## <a name="log-file-checks"></a><span data-ttu-id="4496a-197">Controlli file di registro</span><span class="sxs-lookup"><span data-stu-id="4496a-197">Log File Checks</span></span> 
<span data-ttu-id="4496a-198">Tutti i file di registro delle transazioni generati da un database di Exchange subiscono diverse forme di verifica della coerenza.</span><span class="sxs-lookup"><span data-stu-id="4496a-198">All transaction log files generated by an Exchange database undergo several forms of consistency checks.</span></span> <span data-ttu-id="4496a-199">Quando viene creato un file di registro, la prima cosa da fare è che viene scritto un modello di bit e quindi viene eseguita una serie di scritture dei registri.</span><span class="sxs-lookup"><span data-stu-id="4496a-199">When a log file is created, the first thing done is a bit pattern is written and then a series of log writes is performed.</span></span> <span data-ttu-id="4496a-200">In questo modo Exchange Online esegue una serie di verifiche (perdita di colore, CRC e altri controlli) per convalidare ogni file di registro così come viene scritto e di nuovo come replicato.</span><span class="sxs-lookup"><span data-stu-id="4496a-200">This enables Exchange Online to execute a series of checks (lost flush, CRC and other checks) to validate each log file as it is written, and again as it is replicated.</span></span> 

## <a name="deployment-on-resilient-file-system"></a><span data-ttu-id="4496a-201">Distribuzione nel file System resiliente</span><span class="sxs-lookup"><span data-stu-id="4496a-201">Deployment on Resilient File System</span></span> 
<span data-ttu-id="4496a-202">Per evitare che si verifichino danneggiamenti a livello di file System, Exchange Online viene distribuito su partizioni di file System resilienti per offrire funzionalità di ripristino migliorate.</span><span class="sxs-lookup"><span data-stu-id="4496a-202">To help prevent corruption from occurring at the file system level, Exchange Online is being deployed on Resilient File System (ReFS) partitions to provide improved recovery capabilities.</span></span> <span data-ttu-id="4496a-203">ReFS è un file System in Windows Server 2012 e versioni successive che è stato creato per essere più resistente rispetto al danneggiamento dei dati, massimizzando così la disponibilità e l'integrità dei dati.</span><span class="sxs-lookup"><span data-stu-id="4496a-203">ReFS is a file system in Windows Server 2012 and later that is designed to be more resilient against data corruption thereby maximizing data availability and integrity.</span></span> <span data-ttu-id="4496a-204">In particolare, ReFS apporta miglioramenti alla modalità di aggiornamento dei metadati, offrendo una maggiore protezione dei dati e riduce i casi di danneggiamento dei dati.</span><span class="sxs-lookup"><span data-stu-id="4496a-204">Specifically, ReFS brings improvements in the way that metadata is updated which offers better protection for data and reduces data corruption cases.</span></span> <span data-ttu-id="4496a-205">Vengono inoltre utilizzati checksum per verificare l'integrità dei dati e dei metadati di file e garantire che il danneggiamento dei dati venga facilmente individuato e ripristinato.</span><span class="sxs-lookup"><span data-stu-id="4496a-205">It also uses checksums to verify the integrity of file data and metadata ensuring that data corruption is easily found and repaired.</span></span> 

<span data-ttu-id="4496a-206">Exchange Online si avvale di diversi vantaggi per gli arbitri:</span><span class="sxs-lookup"><span data-stu-id="4496a-206">Exchange Online takes advantage of several ReFS benefits:</span></span> 
- <span data-ttu-id="4496a-207">Maggiore resilienza nell'integrità dei dati significa meno incidenti di danneggiamento dei dati.</span><span class="sxs-lookup"><span data-stu-id="4496a-207">More resiliency in data integrity means fewer data corruption incidents.</span></span> <span data-ttu-id="4496a-208">La riduzione del numero di incidenti di danneggiamento comporta meno reseeding di database inutili.</span><span class="sxs-lookup"><span data-stu-id="4496a-208">Reducing the number of corruption incidents means fewer unnecessary database reseeds.</span></span> 
- <span data-ttu-id="4496a-209">Checksum in esecuzione su metadati che consentono di rilevare i casi di danneggiamento in modo più precoce e deterministico, consentendo di risolvere il danneggiamento dei dati del cliente prima che si verifichino errori grigi sui volumi di dati</span><span class="sxs-lookup"><span data-stu-id="4496a-209">Checksum running on metadata enabling detections of corruption cases sooner and more deterministically, allowing us to fix customer data corruption before grey failures occur on data volumes.</span></span>
- <span data-ttu-id="4496a-210">Progettata per funzionare bene con set di dati di dimensioni estremamente grandi, ovvero petabyte e dimensioni maggiori, senza impatto sulle prestazioni</span><span class="sxs-lookup"><span data-stu-id="4496a-210">Designed to work well with extremely large data sets—petabytes and larger—without performance impact</span></span>
- <span data-ttu-id="4496a-211">Supporto per altre funzionalità utilizzate da Exchange Online, ad esempio la crittografia BitLocker.</span><span class="sxs-lookup"><span data-stu-id="4496a-211">Support for other features used by Exchange Online, such as BitLocker encryption.</span></span> 

<span data-ttu-id="4496a-212">Exchange Online beneficia anche di altre caratteristiche di ReFS:</span><span class="sxs-lookup"><span data-stu-id="4496a-212">Exchange Online also benefits from other ReFS features:</span></span> 
- <span data-ttu-id="4496a-213">**Integrità (flussi di integrità)** -l'arbitro archivia i dati in modo da proteggerli da molti degli errori comuni che in genere possono causare la perdita di dati.</span><span class="sxs-lookup"><span data-stu-id="4496a-213">**Integrity (Integrity Streams)** - ReFS stores data in a way that protects it from many of the common errors that can normally cause data loss.</span></span> <span data-ttu-id="4496a-214">Microsoft 365 Search utilizza flussi di integrità per facilitare il rilevamento dei danni del disco precoce e il checksum del contenuto del file.</span><span class="sxs-lookup"><span data-stu-id="4496a-214">Microsoft 365 Search uses Integrity Streams to help with early disk corruption detection and checksums of file content.</span></span> <span data-ttu-id="4496a-215">La caratteristica riduce anche gli incidenti di danneggiamento causati da "Scritture strappate" (quando un'operazione di scrittura non viene completata a causa di interruzioni di corrente, ecc.).</span><span class="sxs-lookup"><span data-stu-id="4496a-215">The feature also reduces corruption incidents caused by “Torn Writes” (when a write operation does not complete due to power outages, etc.).</span></span> 
- <span data-ttu-id="4496a-216">**Availability (Salvage)** -refs dà la priorità alla disponibilità dei dati.</span><span class="sxs-lookup"><span data-stu-id="4496a-216">**Availability (Salvage)** - ReFS prioritizes the availability of data.</span></span> <span data-ttu-id="4496a-217">Storicamente, i sistemi di file erano spesso suscettibili di danneggiamento dei dati che richiedeva che il sistema venisse portato offline per il ripristino.</span><span class="sxs-lookup"><span data-stu-id="4496a-217">Historically, file systems were often susceptible to data corruption that would require the system to be taken offline for repair.</span></span> <span data-ttu-id="4496a-218">Sebbene sia raro, se si verifica un danneggiamento, ReFS implementa il salvataggio, una funzionalità che rimuove i dati danneggiati dallo spazio dei nomi in un volume attivo e assicura che i dati validi non siano influenzati negativamente dai dati danneggiati non riparabili.</span><span class="sxs-lookup"><span data-stu-id="4496a-218">Although rare, if corruption does occur, ReFS implements salvage, a feature that removes the corrupt data from the namespace on a live volume and ensures that good data is not adversely affected by non-repairable corrupt data.</span></span> <span data-ttu-id="4496a-219">L'applicazione della funzionalità di salvataggio e l'isolamento del danneggiamento dei dati nei volumi di database di Exchange Online significa che è possibile mantenere integro i database non interessati su un volume danneggiato tra il tempo di danneggiamento e l'azione di ripristino.</span><span class="sxs-lookup"><span data-stu-id="4496a-219">Applying the Salvage feature and isolating data corruption to Exchange Online database volumes means that we can keep non-affected databases on a corrupted volume healthy between the time of corruption and repair action.</span></span> <span data-ttu-id="4496a-220">In questo modo si aumenta la disponibilità dei database che in genere sono danneggiati da problemi di danneggiamento del disco.</span><span class="sxs-lookup"><span data-stu-id="4496a-220">This increases the availability of databases that would normally be affected by such disk corruption issues.</span></span> 